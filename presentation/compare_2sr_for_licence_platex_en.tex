% \title{ Сравнение подходов обучения на базе словаря и MAP к проблеме повышения разрешения на примере изображений автомобильных номеров }
\title{Super resolution of car plate images}
\author{
  \begin{tabular}[4cm]{rl}
 Author:                & Ulitin A.~A.\\
 Science supervisor: & Ph.D.~Vakhitov A.~T. \\
 \end{tabular}
 }
\date{2013 year}

\begin{frame}{}
		\maketitle
\end{frame}

% \section{Задача}
% \begin{frame}{Задача Super-resolution}
%   Задача Super resolution --- качественно повысить разрешения изображения.
%   \includegraphics[height=\textheight]{content/An_example_of_super_resolution_with_still_RAW_photo.jpg}
% \end{frame}

\begin{frame}{Why is it possible}
  Image super-resolution use additional knowelege about enviroment:
  \begin{itemize}
    \item Knoweledge of (blur information, camera motion etc)
    \item Knoweledge of imaging object(text, faces, car plates, etc)
    \item Using several images taked from different places
  \end{itemize}

  Adaptability:
  \begin{itemize}
    \item Preprocessing for another CV algorythm.
    \item Extract additional information from several images.
  \end{itemize}
\end{frame}

\begin{frame}{PSNR metric}

  $$ \mathrm{MSE}(\tilde{x},x) = \frac{1}{m\,n}\sum_{i=0}^{m-1}\sum_{j=0}^{n-1} [\tilde{x}(i,j) - x(i,j)]^2$$

  $\mathrm{PSNR}(\tilde{x},x)$.
  $$ \mathrm{PSNR}(\tilde{x},x) &= 10 \cdot \log_{10} \left( \frac{\mathrm{MAX}_I^2}{\mathrm{MSE}(\tilde{x},x)} \right)
  $$
  where $MAX_i$ -- maximum possible pixel value of the image.

\end{frame}

\begin{frame}{Problem formulation}
 $$y_r = D H_R W_R x + n_r,~ ~ ~ 1 \leq r \leq m$$
 where:
 \begin{itemize}
\item $ x $ original image 
\item $ y_r $ observation r    
\item $ D $ matrix downsampling    
\item $ W $ matrix of geometric distortion    
\item $ H_R $ matrix blur observation r    
\item $ n_r $ observation noise r    
\item $ m $ the number of observations 
 \end{itemize}
 Задача найти
 $$ \tilde{x} = \underset{\hat{x}}{\operatorname{argmax}}~  PSNR(\hat{x},x)$$
\end{frame}
\section{Подходы}
\begin{frame}{Сравниваемые подходы}
  \begin{itemize}
    \item Couple Dictionary Training for Image Super-resolution \\
        (Jianchao Yang,Zhaowen Wang, Zhe Lin,Scott Cohen, and Thomas Huang) \\
  Основная идея метода очень проста -- тренировка словаря из патчей небольшого размера в двух разрешениях LR и HR
      \begin{itemize}
        \item Использует пару тренированных словарей
        \item Восстановление по одному изображению
      \end{itemize}
    \item Superresolution of License Plates in Real Traffic Videos \\
      (K. V. Suresh, G. Mahesh Kumar, and A. N. Rajagopalan) \\
      Основная идея -- использование шаговой оптимизации с адаптивным регуляризатором.
      \begin{itemize}
        \item Для восстановление использует последовательную оптимизацию с
          регуляризаторами
        \item Использует несколько изображений
      \end{itemize}
  \end{itemize}
\end{frame}

%\section{Описание подходов}
%\begin{frame}{Подход с тренированными словарями}
%\end{frame}

% \newcommand{\inimage}[2]{
%   \begin{minipage}{#1}
%     \vcenter{\includegraphics[width=\columnwidth]{#2}}
%   \end{minipage}
% }
%
%
% \section{Приведение изображений}
% \begin{frame}{Несколько изображение $\rightarrow$ одно изображение}
%   Для тестирования на однинаковых наборах данных из lr строились псевдо hr для
%   первого алгоритма методом:
%   $$ R = \frac{1}{n}\sum_{i=1}^nW^T \cdot S \cdot IMG_{lr i}$$
%   $S$ --- билинейная интерполяция \\
%   $W$ --- сдвиг
%
%   \inimage{3cm}{content/imgs/append_imgs_big.jpg}
%   $\to$
%   \inimage{6cm}{content/imgs/combined_big.jpg}
% \end{frame}

\begin{frame}{Исходные изображения}
  \includegraphics[width=\columnwidth]{content/out_sr1.png}
\end{frame}

\section{SR1}
\begin{frame}{Результаты подхода алгоритма со словарями}
  \input{../plots/plot_sr1.tex}
\end{frame}

\begin{frame}{Пример изображений алгоритма со словарями}
  \includegraphics[width=\columnwidth]{content/compare_result_sr1.pdf}
\end{frame}

\section{SR2}
\begin{frame}{Результаты подхода}
  \input{../plots/plot_sr2.tex}
\end{frame}

\begin{frame}{Пример изображений алгоритма с регуляризацией}
  \input{../plots/sr2_psnr_rising.tex}
\end{frame}

\begin{frame}{Пример изображений алгоритма с регуляризацией}
  \input{../plots/sr2_psnr_rising_2.tex}
\end{frame}

\begin{frame}{Пример изображений алгоритма с регуляризацией}
%   \begin{tikzpicture}
%     \node (img1) {\includegraphics[width=10cm]{content/sr2_two_1.png}};
%     \node (img1) {\includegraphics[width=10cm]{content/sr2_two_2.png}};
%   \end{tikzpicture}
  \begin{figure}
    \caption{Результат}
    \includegraphics[width=\columnwidth]{content/sr2_two_1.png}\\
  \end{figure}
  \begin{figure}
    \caption{Начальное приближение}
    \includegraphics[width=\columnwidth]{content/sr2_two_2.png}
  \end{figure}
 %\includegraphics[width=\columnwidth]{content/sr2_two_images.pdf}
\end{frame}

\section{Результаты}

\begin{frame}{Результаты}
  \begin{itemize}
    \item Были исследованы и реализованы два подхода к задаче SR
    \item Эксперименты показывают, что оба алгоритма качественно повышают разрешения автомобильного
      номера.
    \item Результаты работы будут опубликованы на конференции СПИСОК-2013
  \end{itemize}
\end{frame}
